<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.paladin.hf.mapper.syst.AdminUserMapper">

	<!-- 物理删除账号 -->
	<delete id="wipeByPrimaryKey">
		DELETE from sys_user WHERE user_id=#{id}
	</delete>
	
	<select id="adminUserLog" resultType="com.paladin.hf.service.syst.vo.SysUserVO">
		SELECT
		au.`unit_id` AS orgUnitId,
		au.`name` AS NAME,
		su.`last_login_time` AS lastLoginTime
		FROM
		sys_user AS su
		LEFT JOIN admin_user AS au
		ON au.id = su.`user_id`
		WHERE au.`is_delete` = '0'
		AND (
		DATE_SUB(CURDATE(), INTERVAL 7 DAY) >= DATE(su.`last_login_time`)
		OR su.`last_login_time` IS NULL
		) 
		<if test="unitId !=null and unitId !='' ">
		 AND au.`unit_id`=#{unitId}
		</if>
	
	</select>
	
</mapper>