<!DOCTYPE HTML>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head th:include="/hf/header">
</head>
<body>
    <input type="hidden" id="userId" th:value="${user.id}"/>
    
<tt:constant enumcode="ass-grades,job-duties-type,sex-type" />
<div class="container">
<section class="content">
            <div class="box box-primary">
                <div class="box-header with-border">
                        <div class="pull-right">
                            <a href="/person/cyc/index" class="btn btn-warning"><i class="glyphicon glyphicon-share-alt"></i>返回</a>
                        </div>
                          <h1 class="box-title">周期考评-个人</h1>
                </div>
                <div class="box-body">
                    <div id="model_user_view" class="box-body">
	                    <form class="form-horizontal">
		                    <fieldset>
		                       <legend>个人基本信息</legend>
		                       <div class="form-group">
		                           <label class="col-sm-2 control-label">姓名</label>
		                           <div class="col-sm-3">
		                               <p name="name" class="form-control-static description"/>
		                           </div>
		                           <label class="col-sm-2 control-label">性别</label>
		                           <div class="col-sm-3">
		                               <p name="sex" class="form-control-static description"/>
		                           </div>
		                       </div>
		                       <div class="form-group">
		                           <label class="col-sm-2 control-label">出生日期</label>
		                           <div class="col-sm-3">
		                               <p name="birthday" class="form-control-static description"/>
		                           </div>
		                           <label class="col-sm-2 control-label">职务</label>
		                           <div class="col-sm-3">
		                               <p name="jobDuties" class="form-control-static description"/>
		                           </div>
		                       </div>
		                    </fieldset>
	                    </form>
                    </div>
                    
                
                    <form class="form-horizontal tonto-form-validate" id="unitForm" action="/person/cyc/confirm" callback-url="/person/cyc/index" method="post" th:object="${perCycAss}">
                    		<input type="hidden" name="id"  th:field="*{id}"/>
                            <input type="hidden" name="fuserId" th:value="${user.id}"/>
                            <input type="hidden" name="fcycleId" th:value="${assessCycle.id}"/>
                        <fieldset id="fieldset1">
                        <legend>考评周期</legend>
                        <div class="form-group">
                            <label for="cycleName" class="col-sm-2 control-label">考评周期</label>
					      	    <div class="col-sm-3">
                                       <input type="text" class="form-control" required="required" th:value="${assessCycle.cycleName}" placeholder="请选择周期"/>
                                </div>
                                <span onclick="quantitativeScores()" class="btn btn-default"><i class="glyphicon glyphicon-search"></i>&nbsp;&nbsp;个人量化总分</span>  
                                 
                        </div>
                         </fieldset>
                       
                       <fieldset id="fieldset2">
                       <legend>本年度医德医风工作总结</legend>
                        <div class="form-group">
                            <label for="workSummary" class="col-sm-2 control-label">工作总结</label>
                            <div class="col-sm-8">
                                <textarea type="text" name="workSummary" required="required" class="form-control" id="workSummary" rows="3" maxlength="200" th:inline="text"  th:field="*{workSummary}"></textarea>
                            </div>
                        </div>
                        </fieldset>
                        
                        <fieldset id="fieldset3">
                        <legend>自评意见</legend>
                        <div class="form-group">
                            <label for="selfAssOpinion" class="col-sm-2 control-label">自评意见</label>
                            <div class="col-sm-8">
                                <textarea type="text"  name="selfAssOpinion" required="required" class="form-control" id="selfAssOpinion" rows="3" maxlength="200" th:inline="text"  th:field="*{selfAssOpinion}"></textarea>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="selfAssGrade" class="col-sm-2 control-label">自评等次</label>
					      	<div class="col-sm-3">
                        		<select name="selfAssGrade" id="selfAssGrade" class="form-control tonto-select-constant" enumcode="ass-grades" th:attr="selectedvalue=${perCycAss.selfAssGrade}">
                        		</select>     
                            </div>
                            	
                            	
                            	<label for="assessedSign" class="col-sm-2 control-label">自评签字</label>
	                            <div class="col-sm-3">
	                              <input type="text" name="assessedSign"  required="required" class="form-control"    maxlength="20" th:field="*{assessedSign}"  />
	                            </div>
					      	
                        </div >
                        	<div class="form-group">
	                        	<label for="selfAssTime" class="col-sm-2 control-label">自评时间</label>
	                            <div class="col-sm-3">
	                              <input type="text" name="selfAssTime" required="required" class="form-control tonto-datepicker-date" id="selfAssTime"   maxlength="20" th:field="*{selfAssTime}"  />
	                            </div>
                           </div>
                         </fieldset>
                        
                        <fieldset id="fieldset4">
                        <legend>科室（病区）意见</legend>
                        <div class="form-group">
                            <label for="departOpinion" class="col-sm-2 control-label">科室（病区）意见</label>
                             <div class="col-sm-8">
                                <textarea type="text" name="departOpinion" class="form-control" id="departOpinion" rows="3" maxlength="200" th:inline="text"  th:field="*{departOpinion}"></textarea>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="departGrade" class="col-sm-2 control-label">考评等次</label>
                            <div class="col-sm-3">
	                           	<select name="departGrade" id="departGrade" class="form-control tonto-select-constant" enumcode="ass-grades" th:attr="selectedvalue=${perCycAss.departGrade}">
	                       			<option value="">请选择</option>
	                       		</select>
                        	</div>  
                        	<label for="depAssessorSign" class="col-sm-2 control-label">科室签字</label>
                        	<div class="col-sm-3" >
                        		<input type="text" name="depAssessorSign" class="form-control" id="depAssessorSign" maxlength="20" th:field="*{depAssessorSign}"/>
                        	</div>
                        	
                        </div>
                        <div class="form-group">
                        	<label for="departAssTime" class="col-sm-2 control-label">考评时间</label>
                             <div class="col-sm-3">
                             	<input type="text" name="departAssTime" class="form-control tonto-datepicker-date" id="departAssTime"   maxlength="20" th:field="*{departAssTime}"  />
                         	</div>
                         </div>
                         	
                        </fieldset>
                        
                        <fieldset id="fieldset5">
                        <legend>考评领导小组评价意见</legend>
                        <div class="form-group">
                            <label for="unitGroupOpinion" class="col-sm-2 control-label">考评领导小组评价意见</label>
                             <div class="col-sm-8">
                                <textarea type="text" name="unitGroupOpinion" class="form-control" id="unitGroupOpinion" rows="3" maxlength="200" th:inline="text"  th:field="*{unitGroupOpinion}"></textarea>
                            </div>
                        </div>
                         <div class="form-group">
                            <label for="unitAssGrade" class="col-sm-2 control-label">考评等次</label>
                            <div class="col-sm-3">
                        		<select name="unitAssGrade" id="unitAssGrade" class="form-control tonto-select-constant" enumcode="ass-grades" th:attr="selectedvalue=${perCycAss.unitAssGrade}">
                        			<option value="">请选择</option>
                        		</select>     
                            </div>
                            <label for="unitAssessorSign" class="col-sm-2 control-label" >小组签字</label>
                            <div class="col-sm-3" >
                            	<input type="text" name="unitAssessorSign" class="form-control" id="unitAssessorSign" maxlength="20" th:field="*{unitAssessorSign}" />
                            </div>
                        </div>
                        
                        <div class="form-group">
                        	<label for="unitAssTime" class="col-sm-2 control-label">考评时间</label>
                             <div class="col-sm-3">
                             <input type="text" name="unitAssTime" class="form-control tonto-datepicker-date" id="unitAssTime"   maxlength="20" th:field="*{unitAssTime}"  />
                            </div>
                        
                        </div>
                        </fieldset>
                        
                        <fieldset>
                        <legend>被考核人对考评等次的确认</legend>
                        <div class="form-group">
                            	<label for="confirmedResult" class="col-sm-2 control-label">被考核人对考评等次的确认</label>
                            	<div class="col-sm-3">
	                                <input type="radio" name="confirmedResult"  value="0"/>不同意
	                            	<input type="radio" name="confirmedResult"  value="1"/>同意
                            	</div>
                            	<input type="hidden" th:field="*{confirmedResult}" id="confirmedResult" />
                            	<label for="assessedConfirmSign" class="col-sm-2 control-label">自评确认签字</label>
	                            <div class="col-sm-3">
	                              <input type="text"  class="form-control" name="assessedConfirmSign"   maxlength="20" th:value="${user.name}"  />
	                            </div>	
                            	
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmedTime" class="col-sm-2 control-label">确认时间</label>
                             <div class="col-sm-3">
                                <input type="text" name="confirmedTime" class="form-control tonto-datepicker-date" id="confirmedTime"    maxlength="20" th:field="*{confirmedTime}"  />
                            </div>
                        </div>
                                                   
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <button type="submit" class="btn btn-primary" id="btnSubmit">考评结果确认</button>
                            </div>
                        </div>
                        </fieldset>
                        
                    </form>
                </div>
            </div>
</section>
</div>
<div th:include="/hf/footer"></div>

<script type="text/javascript">


	var options_user = {
	        id: "model_user",
	        name: "详情",
	        columns: [
	            { title: "姓名", name: "name", inputType: "TEXT"},
	            { title: "性别", name: "sex", inputType: "SELECT",enum:"sex-type"},
	            { title: "出生日期", name: "birthday", inputType: "DATE"},
	            { title: "职务", name: "jobDuties", inputType: "SELECT", enum:"job-duties-type"}
	                  
	        ]
	    }


	var userId = $("#userId").val();
	
	$(function() {
		/*<![CDATA[*/
		           
		$.getAjax("/person/cyc/find/user?id=" + userId, function(data) {
            var model_user = new tonto.Model("model_user", options_user.columns, {
                extraParam:{
                    id:userId
                }
            });
            model_user.setData(data);
        });
		           
		           
		           
		//confirmedResult：被考评人确认结果
		var crval = $("#confirmedResult").val();
		$("#confirmedResult").attr("name","");
		if(crval){
			$("input[name='confirmedResult'][value="+crval+"]").attr("checked",true); 
		}
		
		 /*------判断radio是否有选中，获取选中的值--------*/
		 $(function(){
	         $("#btnSubmit").click(function(){
	            var val=$('input:radio[name="confirmedResult"]:checked').val();
	            if(val==null){
	                $.failMessage("考评等次还没确认!")
	                return false;
	            }
	            return true;
	     });
		})
		
	
	});

	$("#fieldset1").find("input,select,textarea").attr({disabled:true,readonly:true});
	$("#fieldset2").find("input,select,textarea").attr({disabled:true,readonly:true});
	
	$("#fieldset3").find("input,select,textarea").attr({disabled:true,readonly:true});
	$("#fieldset3").find(".tonto-datepicker-date").css("background","#eee");
	
	$("#fieldset4").find("input,select,textarea").attr({disabled:true,readonly:true});
	$("#fieldset4").find(".tonto-datepicker-date").css("background","#eee");
	
	$("#fieldset5").find("input,select,textarea").attr({disabled:true,readonly:true});
	$("#fieldset5").find(".tonto-datepicker-date").css("background","#eee");

	
	$(function() {
			FormatDate(new Date());
	});
	
	function FormatDate(strTime) {
		var date = new Date(strTime);
		var date2 = date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate();
		$('#confirmedTime').val(date2);
	}

    function quantitativeScores() {
    	var nuserId = $('input[name="fuserId"]').val() ;
    	var ncycleId = $('input[name="fcycleId"]').val() ;
    	layer.open({
    		type: 2,
    		title: '等级配置',
    		maxmin: true,
    		area: $.getOpenLayerSize(900,450),
    		content: "/console/assess/level/searchTemplateIdByCycleId?cycleId=" + ncycleId + "&buserId=" + nuserId 
    	});
		
	}
	/*]]>*/
</script>

</body>
</html>