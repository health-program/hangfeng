<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:include="console/header">
</head>

<body>
    <section class="content-header">
        <h1>人员量化考评-科室</h1>
        <small>人员列表</small>
    </section>
    <section class="content-header">
        <div style="border: 1px #ddd solid; padding-top:20px" class="box-body">
            <form id="searchbar" class="form-horizontal">
                <div class="form-group">
                    <label for="unitId" style="width:130px" class="col-sm-2 control-label">被考评科室</label>
                    <div class="col-sm-2">
                        <input type="text" class="form-control tonto-select-department" name="unitId" placeholder="请选择科室"></input>
                    </div>
                    <label for="name" style="width:130px" class="col-sm-2 control-label">姓名</label>
                    <div class="col-sm-2">
                        <input type="text" name="name" class="form-control" />
                    </div>
                    <label for="jobRank" style="width:80px" class="col-sm-2 control-label">职称</label>
                    <div class="col-sm-2">
                        <select name="jobRank" class="form-control tonto-select-constant" enumcode="job-rank-type">
                            <option value="">请选择</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="isAssessor" style="width:130px" class="col-sm-2 control-label">是否考评人员</label>
                    <div class="col-sm-2">
                        <select name="isAssessor" class="form-control tonto-select-constant" enumcode="boolean-type">
                            <option value="">请选择</option>
                        </select>
                    </div>
                    <label for="startRecordCreateTime" style="width:130px" class="col-sm-2 control-label">建档时间</label>
                    <div class="col-sm-2">
                        <input type="text" name="startRecordCreateTime" class="form-control col-sm-2 tonto-datepicker-date" readonly="readonly" placeholder="请选择日期" />
                    </div>
                    <label for="endRecordCreateTime" style="width:80px;text-align:center" class="col-sm-2 control-label">至</label>
                    <div class="col-sm-2">
                        <input type="text" name="endRecordCreateTime" class="form-control col-sm-2 tonto-datepicker-date" readonly="readonly" placeholder="请选择日期" />
                    </div>                    
                </div>
                <div class="form-group">
                    <label style="width: 130px" for="assessCycleId" class="col-sm-2 control-label">考评周期</label>
                    <div class="col-sm-2">
                        <input type="text" class="form-control tonto-select-assess-cycle" required="required" th:attr="cycleid=${assessCycleId},cyclename=${assessCycleName}" name="assessCycleId" placeholder="请选择周期"></input>
                    </div>
                    <label style="width: 130px" for="isAssessed" class="col-sm-2 control-label">是否已考评</label>
                    <div class="col-sm-2">
                        <select class="col-sm-2 form-control" name="isAssessed">
                            <option value="">请选择</option>
                            <option value="1">是</option>
                            <option value="0">否</option>
                        </select>
                    </div>
                    <label for="name" style="width:80px" class="col-sm-2 control-label"></label>
                    <div class="col-sm-2" style="text-align:right">
                        <a href="javascript:table.refresh();" class="btn btn-primary">查询</a>
                        <button type="reset" class="btn">重置</button>
                    </div>                  
                </div>              
            </form>
        </div>
    </section>
    <section class="content table-content">
        <table id="dataGrid"></table>
    </section>
    <div id="toolbar">
    </div>
    <div th:include="console/footer"></div>
    <script type="text/javascript">
    /*<![CDATA[*/
    var table;
    $(function() {
        $.getConstantEnum(["boolean-type", "sex-type", "job-duties-type", "job-rank-type", "oeducation-type"], initDataGrid);
    });

    function initDataGrid(enumMap) {    	
        table = $.createTable("#dataGrid", {
            idField: "id",
            columns: [
                [
                	{ title: "是否已考评", formatter: function(value, row, index){return (row.assessState && row.assessState != '0')? '是':'否'} },
                    { title: "所在单位", field: "unitRootName" },
                    { title: "被考评科室", field: "unitName" },
                    { title: "是否考评人", field: "isAssessor", formatter: $.getEnumColumnFormatter(enumMap, "boolean-type") },
                    { title: "姓名", field: "name" },
                    { title: "性别", field: "sex", formatter: $.getEnumColumnFormatter(enumMap, "sex-type") },
                    { title: "职称", field: "jobRank", formatter: $.getEnumColumnFormatter(enumMap, "job-rank-type") },
                    { title: "职务", field: "jobDuties", formatter: $.getEnumColumnFormatter(enumMap, "job-duties-type") },
                    { title: "学历", field: "oeducation", formatter: $.getEnumColumnFormatter(enumMap, "oeducation-type") },
                    { title: "建档时间", field: "recordCreateTime" },
                    
                    {
                        title: "量化考评",
                        width: "100px",
                        align: 'center',
                        events: {
                            'click .assess': function(e, value, row, index) {
                            	assess(row);
                            }
                        },
                        formatter: $.tableColumnFormatter('量化考评', 'assess')
                    },
                    {
                        title: "查看",
                        width: "60px",
                        align: 'center',
                        events: {
                            'click .view': function(e, value, row, index) {
                                view(row);
                            }
                        },
                        formatter: $.viewColumnFormatter()
                    }
                ]
            ],
            url: '/console/assess/quantitative/department/user',
            searchbar: '#searchbar',
            pagination: true,
            toolbar: "#toolbar",
            showRefresh: true,
            showToggle : true
        });
    }

    function assess(row) {
    	var cycleId = $('[name="assessCycleId"]').val();
    	window.location = "/console/assess/quantitative/user/index?userId=" + row.id + "&cycleId="+cycleId;
    }

    function view(row) {
       
    }
    /*]]>*/
    </script>
</body>

</html>