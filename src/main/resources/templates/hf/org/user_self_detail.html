<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:include="/hf/header" />

<body>
    <tt:constant enumcode="boolean-type,sex-type,nation-type,partisan-type,job_level,certificate-type,job-duties-type,job-rank-type,oeducation-type,user_property_type,ass-grades,operate-state" />
    <div class="container">
        <section class="content-header">
            <h1>个人医德医风档案</h1>
        </section>
        <section class="content">
            <div class="box box-solid">
                <div class="box-header with-border">
                    <i class="glyphicon glyphicon-user"></i>
                    <h3 class="box-title">人员基本信息</h3>
                    <div class="box-tools pull-right">
                        <a class="btn" id="model_edit_btn" href="javascript:void(0)"><i class="fa fa-edit"></i>编辑</a>
                    </div>
                </div>
                <div id="model_view" class="box-body">
                    <form class="form-horizontal">
                        <div class="form-group">
                            <label for="name" class="col-sm-3 control-label">姓名：</label>
                            <div class="col-sm-3">
                                <p name="name" class="form-control-static description"></p>
                            </div>
                            <label for="sex" class="col-sm-2 control-label">性别：</label>
                            <div class="col-sm-3">
                                <p name="sex" class="form-control-static description" enumcode="sex-type"></p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="identificationType" class="col-sm-3 control-label">身份证件类型：</label>
                            <div class="col-sm-3">
                                <p name="identificationType" class="form-control-static description" enumcode="" certificate-type""></p>
                            </div>
                            <label for="identification" class="col-sm-2 control-label">身份证件号码：</label>
                            <div class="col-sm-3">
                                <p name="identification" class="form-control-static description"></p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="userProperty" class="col-sm-3 control-label">人员属性：</label>
                            <div class="col-sm-3">
                                <p name="userProperty" class="form-control-static description" enumcode="user_property_type"></p>
                            </div>
                            <label for="orgUnitId" class="col-sm-2 control-label">所属科室：</label>
                            <div class="col-sm-3">
                                <p name="orgUnitId" class="form-control-static description"></p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="isAssessor" class="col-sm-3 control-label">是否考评人员：</label>
                            <div class="col-sm-3">
                                <p name="isAssessor" class="form-control-static description"></p>
                            </div>
                            <label for="assessUnitId" class="col-sm-2 control-label">考评科室：</label>
                            <div class="col-sm-3">
                                <p name="assessUnitId" class="form-control-static description"></p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="birthday" class="col-sm-3 control-label">出生日期：</label>
                            <div class="col-sm-3">
                                <p name="birthday" class="form-control-static description"></p>
                            </div>
                            <label for="cellphone" class="col-sm-2 control-label">手机号码：</label>
                            <div class="col-sm-3">
                                <p name="cellphone" class="form-control-static description"></p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="nation" class="col-sm-3 control-label">民族：</label>
                            <div class="col-sm-3">
                                <p name="nation" class="form-control-static description"></p>
                            </div>
                            <label for="partisan" class="col-sm-2 control-label">党派：</label>
                            <div class="col-sm-3">
                                <p name="partisan" class="form-control-static description"></p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="jobDuties" class="col-sm-3 control-label">职务：</label>
                            <div class="col-sm-3">
                                <p name="jobDuties" class="form-control-static description" enumcode="job-duties-type"></p>
                            </div>
                            <label for="jobRank" class="col-sm-2 control-label">职称：</label>
                            <div class="col-sm-3">
                                <p name="jobRank" class="form-control-static description" enumcode="job-rank-type"></p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="jobLevel" class="col-sm-3 control-label">职级：</label>
                            <div class="col-sm-3">
                                <p name="jobLevel" class="form-control-static description" enumcode="job_level"></p>
                            </div>
                            <label for="oeducation" class="col-sm-2 control-label">学历：</label>
                            <div class="col-sm-3">
                                <p name="oeducation" class="form-control-static description" enumcode="oeducation-type"></p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="startWorkTime" class="col-sm-3 control-label">参加工作时间：</label>
                            <div class="col-sm-3">
                                <p name="startWorkTime" class="form-control-static description"></p>
                            </div>
                            <label for="comeUnitTime" class="col-sm-2 control-label">进单位时间：</label>
                            <div class="col-sm-3">
                                <p name="comeUnitTime" class="form-control-static description"></p>
                            </div>
                        </div>
                        <div class="form-group">
                         <label for="recordCreateTime" class="col-sm-3 control-label">建档日期：</label>
                            <div class="col-sm-3">
                                <p name="recordCreateTime" class="form-control-static description"></p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="resume" class="col-sm-3 control-label">个人简历：</label>
                            <div class="col-sm-8">
                                <pre name="resume" style="min-height:150px" class="form-control-static description"></pre>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="reward" class="col-sm-3 control-label">历年奖励：</label>
                            <div class="col-sm-8">
                                <pre name="reward" style="min-height:150px" class="form-control-static description"></pre>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="punish" class="col-sm-3 control-label">历年惩处：</label>
                            <div class="col-sm-8">
                                <pre name="punish" style="min-height:150px" class="form-control-static description"></pre>
                            </div>
                        </div>
                    </form>
                </div>
                <div id="model_edit" class="box-body" style="display: none">
                    <form id="model_form" action="/org/user/self/update" method="post" class="form-horizontal edit-body">
                        <div class="form-group">
                            <label for="sex" class="col-sm-3 control-label">性别：</label>
                            <div class="col-sm-3">
                                <select name="sex" class="form-control tonto-select-constant" enumcode="sex-type">
                                </select>
                            </div>
                            <label for="userProperty" class="col-sm-2 control-label">人员属性：</label>
                            <div class="col-sm-3">
                                <select name="userProperty" class="form-control tonto-select-constant" enumcode="user_property_type">
                                    <option value="">请选择</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="birthday" class="col-sm-3 control-label">出生日期：</label>
                            <div class="col-sm-3">
                                <input name="birthday" autocomplete="off" placeholder="请输入出生日期" type="text" class="form-control tonto-datepicker-date" />
                            </div>
                            <label for="cellphone" class="col-sm-2 control-label">手机号码：</label>
                            <div class="col-sm-3">
                                <input name="cellphone"  placeholder="请输入手机号码" type="text" class="form-control" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="nation" class="col-sm-3 control-label">民族：</label>
                            <div class="col-sm-3">
                                <select name="nation" class="form-control tonto-select-constant" enumcode="nation-type">
                                    <option value="">请选择</option>
                                </select>
                            </div>
                            <label for="partisan" class="col-sm-2 control-label">党派：</label>
                            <div class="col-sm-3">
                                <select name="partisan" class="form-control tonto-select-constant" enumcode="partisan-type">
                                    <option value="">请选择</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="jobDuties" class="col-sm-3 control-label">职务：</label>
                            <div class="col-sm-3">
                                <select name="jobDuties" class="form-control tonto-select-constant" enumcode="job-duties-type">
                                    <option value="">请选择</option>
                                </select>
                            </div>
                            <label for="jobRank" class="col-sm-2 control-label">职称：</label>
                            <div class="col-sm-3">
                                <select name="jobRank" class="form-control tonto-select-constant" enumcode="job-rank-type">
                                    <option value="">请选择</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="jobLevel" class="col-sm-3 control-label">职级：</label>
                            <div class="col-sm-3">
                                <select name="jobLevel" class="form-control tonto-select-constant" enumcode="job_level">
                                    <option value="">请选择</option>
                                </select>
                            </div>
                            <label for="oeducation" class="col-sm-2 control-label">学历：</label>
                            <div class="col-sm-3">
                                <select name="oeducation" class="form-control tonto-select-constant" enumcode="oeducation-type">
                                    <option value="">请选择</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="startWorkTime" class="col-sm-3 control-label">参加工作时间：</label>
                            <div class="col-sm-3">
                                <input name="startWorkTime" autocomplete="off" placeholder="请输入参加工作时间" type="text" class="form-control tonto-datepicker-date" />
                            </div>
                            <label for="comeUnitTime" class="col-sm-2 control-label">进单位时间：</label>
                            <div class="col-sm-3">
                                <input name="comeUnitTime" autocomplete="off" placeholder="请输入进单位时间" type="text" class="form-control tonto-datepicker-date" />
                            </div>
                        </div>
                        <div class="form-group">
                        <label for="recordCreateTime" class="col-sm-3 control-label">建档日期：</label>
                            <div class="col-sm-3">
                                <input name="recordCreateTime" autocomplete="off" placeholder="请输入建档日期" type="text" class="form-control tonto-datepicker-date" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="resume" class="col-sm-3 control-label">个人简历：</label>
                            <div class="col-sm-8">
                                <textarea name="resume" rows="5" placeholder="请输入个人简历" maxlength="2000" class="form-control"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="reward" class="col-sm-3 control-label">历年奖励：</label>
                            <div class="col-sm-8">
                                <textarea name="reward" rows="5" placeholder="请输入历年奖励" maxlength="2000" class="form-control"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="punish" class="col-sm-3 control-label">历年惩处：</label>
                            <div class="col-sm-8">
                                <textarea name="punish" rows="5" placeholder="请输入历年惩处" maxlength="2000" class="form-control"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-2 col-sm-offset-3">
                                <button type="submit" id="model_form_submit_btn" class="btn btn-primary btn-block">保存</button>
                            </div>
                            <div class="col-sm-2 col-sm-offset-1">
                                <button type="button" id="model_form_cancel_btn" class="btn btn-default btn-block">取消</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="box box-solid" style="margin-top:20px">
                <div class="box-header with-border">
                    <i class="fa fa-list-alt"></i>
                    <h3 class="box-title">人员考评信息</h3>
                </div>
                <div id="result" class="box-body">
                    <table id="dataGrid"></table>
                    <div id="toolbar">
                    </div>
                </div>
            </div>
        </section>
    </div>
    <input type="hidden" id="id" th:value="${id}" />
    <div th:include="/hf/footer" />
    <script type="text/javascript">
    var options = {
        id: "model",
        name: "详情",
        url: "/org/user/self/update",
        columns: [
            { title: "账号", name: "account", inputType: "TEXT", colspan: 2 },

            { title: "姓名", name: "name", inputType: "TEXT" },
            { title: "性别", name: "sex", inputType: "SELECT", enum: "sex-type" },
            { title: "身份证件类型", name: "identificationType", inputType: "SELECT", enum: "certificate-type" },
            { title: "身份证件号码", name: "identification", inputType: "TEXT" },

            { title: "人员属性", name: "userProperty", inputType: "SELECT", enum: "user_property_type" },
            { title: "所属科室", name: "orgUnitId", inputType: "UNIT", viewName: "unitName", unitType: "tonto-select-department" },
            { title: "是否考评人员", name: "isAssessor", inputType: "SELECT", enum: "boolean-type" },
            { title: "考评科室", name: "assessUnitId", inputType: "UNIT", viewName: "assessUnitName", unitType: "tonto-select-unit", dependency: ["isAssessor", "1"] },

            { title: "出生日期", name: "birthday", inputType: "DATE" },
            { title: "手机号码", name: "cellphone", inputType: "TEXT" },
            { title: "建档日期", name: "recordCreateTime", inputType: "DATE" },

            { title: "民族", name: "nation", inputType: "SELECT", enum: "nation-type" },
            { title: "党派", name: "partisan", inputType: "SELECT", enum: "partisan-type" },

            { title: "职务", name: "jobDuties", inputType: "SELECT", enum: "job-duties-type" },
            { title: "职称", name: "jobRank", inputType: "SELECT", enum: "job-rank-type" },

            { title: "职级", name: "jobLevel", inputType: "SELECT", enum: "job_level" },
            { title: "学历", name: "oeducation", inputType: "SELECT", enum: "oeducation-type" },

            { title: "参加工作时间", name: "startWorkTime", inputType: "DATE" },
            { title: "进单位时间", name: "comeUnitTime", inputType: "DATE" },

            { title: "个人简历", name: "resume", inputType: "TEXTAREA", colspan: 2 },
            { title: "历年奖励", name: "reward", inputType: "TEXTAREA", colspan: 2 },
            { title: "历年惩处", name: "punish", inputType: "TEXTAREA", colspan: 2 }
        ]
    };
    var table, userId;
    $(function() {
        userId = $("#id").val();
        $.getAjax("/org/user/self/get", function(data) {
            var model = new tonto.Model("model", options.columns, {
                extraParam: {
                    id: userId
                }
            });
            model.setData(data);
        });

        table = $.createTable("#dataGrid", {
            idField: "id",
            columns: [
                [
                    { title: "考评周期", field: "assessCycleName" },
                    { title: "自评等级", field: "selfAssGrade", enumcode: "ass-grades" },
                    { title: "科室考评等级", field: "departGrade", enumcode: "ass-grades" },
                    { title: "医院考评等级", field: "unitAssGrade", enumcode: "ass-grades" },
                    { title: "操作状态", field: "operateState", enumcode: "operate-state" },
                    {
                        title: "查看",
                        align: 'center',
                        events: {
                            'click .detail': function(e, value, row, index) {
                                viewAssess(row);
                            },
                            'click .print': function(e, value, row, index) {
                                print(row);
                            }
                        },
                        formatter: function(value, row, index) {
                            var html = '<button class="detail btn btn-xs btn-info"><i class="fa fa-search"></i>查看</button>';
                            if (row.operateState >= 5) {
                                html += '<button class="print btn btn-xs btn-success" style="margin-left:10px"><i class="fa fa-print"></i>打印</button>'
                            }
                            return html;
                        }
                    }
                ]
            ],
            url: '/assess/cycle/personal/user/find?userId=' + userId,
            pagination: true,
            showRefresh: true
        });
    });

    function viewAssess(row) {
        $.openUrlLayerOrLocate("/assess/cycle/personal/user/detail?id=" + row.id, {
            title: "周期考评情况",
            width: 900,
            height: 800
        })
    }

    function print(row) {
        $.openUrlLayerOrLocate("/assess/cycle/personal/user/print/input?id=" + row.id, {
            title: "周期考评打印",
            width: 900,
            height: 800
        })
    }
    </script>
</body>

</html>