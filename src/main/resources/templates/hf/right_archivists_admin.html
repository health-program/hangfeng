<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:include="/hf/header"/>
<style>
.notice-list {
    list-style: none;
}

.right-tool {
    float: right;
    color: #999;
}

.list {
    list-style: none;
    float: left;
    text-align: center;
    width: 23%
}

.right-text {
    display: inline;
    float: right;
}

.name-box {
    display: inline-block;
    height: 54px;
    width: 140px;
}

.fa-check-square-o {
    font-size: 54px;
}

.p1 {
    color: #666666;
    font-size: 14px;
    line-height: 18px;
}

.p2 {
    color: #666666;
    line-height: 20px;
    font-size: 22px;
}

.go-todo-btn {
    padding
}

.name {
    color: #000;
}

.name:hover,
.name:active,
.name:focus {
    color: #000;
    text-decoration: underline
}

.btn-primary {
    background-color: #00a65a;
    border-color: #00a65a
}

.btn-primary:hover {
    background-color: #1ddc50;
    border-color: #1ddc50
}

.p-number strong {
    font-size: 24px
}

.ul-dashed {
    border-bottom: 1px dashed #dddddd;
    padding-left: 12px;
    line-height: 25px;
    margin-right: 21px;
}

.notice-li {
    margin-bottom: 6px;
}

.info-box-text {
    font-size: 20px;
}

.info-box-content {
    padding: 5px 25px;
}

.text-view {
    margin-left: 90px;
    text-align: right;
    margin-right: 19px;
}

#noticeContent p {
    margin-left: 15px;
}

.content {
    min-height: 250px;
    padding: 30px;
    margin-right: auto;
    margin-left: auto;
    padding-left: 30px;
    padding-right: 30px;
}
.input-group{width: 250px;}
.notice-li a{cursor:pointer}
</style>
<body>
	<div class="container">
	 <tt:constant enumcode="job-rank-type,KSYDYF_PJDJ" />
		<section class="content">
		<div class="row">
			<div class="col-md-12">
				<div class="box box-primary">
					<div class="box-header with-border">
					<i class="fa fa-pie-chart" aria-hidden="true"></i>
					<h3 class="box-title">考评结果汇总</h3>
					 <div class="pull-right">
					 	<div class="row">
                            <div class="col-sm-8" style="margin-top: -2px;">
                                <input type="text" id="assessCycleCom" name="assessCycleId" class="form-control tonto-select-assess-cycle" required="required" th:attr="cycleid=${assessCycleId},cyclename=${assessCycleName}" placeholder="请选择周期" />
                            </div>
                            <div class="col-sm-2" style="margin-top: -2px;">
                            	<button type="button" style="width:100px" class="btn btn-primary tonto-btn-search" onclick="query()"><i class="fa fa-search"></i>查询</button>
                            </div>
                        </div>
              		</div> 
					</div>
					 
					<div id="main" style="height: 300px"></div>
				</div>
			</div>
			</div>
			<div class="row">
				<div class="col-md-6" style="padding-right: 10px;">
					<div class="box box-info">
						<div class="box-header with-border">
						<i class="fa fa-bullhorn"></i>
						<h3 class="box-title">通知公告</h3>
						<a style="float:right" href="/inforelease/more/index?isHomePage=true&type=0">更多<i class="fa fa-angle-double-right "></i> </a>
						</div>
						<div style="height: 216px">
							<ul class="notice-list ul-dashed" th:each="o:${list}"
								th:if=" ${o.types} == '0' ">
								<li class="notice-li"><a class="name"
									th:href="@{/inforelease/info/detail?isHomePage=true(id=${o.id})}"><span
									th:title="${o.title}" th:text=${o.title}></span></a>
									<div class="right-tool">
										<span th:text=${o.releaseTime}></span>
									</div></li>
							</ul>
						</div>
					</div>
					</div>
					<div class="col-md-6" style="padding-left: 10px;">
					<div class="box box-info">
						<div class="box-header with-border">
						<i class="fa fa-folder-open"></i>
						<h3 class="box-title">政策文件</h3>
						<a style="float:right" href="/inforelease/more/index?isHomePage=true&type=1">更多<i class="fa fa-angle-double-right "></i></a>
						</div>
						<div style="height: 216px">
							<ul class="notice-list ul-dashed" th:each="o:${list}"
								th:if=" ${o.types} == '1' ">
								<li class="notice-li"><a class="name"
									th:href="@{/inforelease/info/detail?isHomePage=true(id=${o.id})}"><span
									th:title="${o.title}" th:text=${o.title}></span></a>
									<div class="right-tool">
										<span th:text=${o.releaseTime}></span>
									</div></li>
							</ul>
						</div>
					</div>
					</div>
				</div>
				<div class="row">
				<div class="col-md-6" style="padding-right: 10px;">
					<div class="box box-success">
						<div class="box-header with-border">
						<i class="fa fa-book" aria-hidden="true"></i>
						<h3 class="box-title">宣传教育</h3>
						<a style="float:right" href="/inforelease/more/index?isHomePage=true&type=2">更多<i class="fa fa-angle-double-right "></i> </a>
						</div>
						<div style="height: 216px">
							<ul class="notice-list ul-dashed" th:each="o:${list}"
								th:if=" ${o.types} == '2' ">
								<li class="notice-li"><a class="name"
									th:href="@{/inforelease/info/detail?isHomePage=true(id=${o.id})}"><span
									th:title="${o.title}" th:text=${o.title}></span></a>
									<div class="right-tool">
										<span th:text=${o.releaseTime}></span>
									</div></li>
							</ul>
						</div>
					</div>
					
					</div>
					<div class="col-md-6" style="padding-left: 10px;">
					<div class="box box-warning">
						<div class="box-header with-border">
						<i class="fa fa-lightbulb-o" aria-hidden="true"></i>
						<h3 class="box-title">廉政提醒</h3>
						<a style="float:right" href="/inforelease/more/index?isHomePage=true&type=3">更多<i class="fa fa-angle-double-right "></i></a>
						</div>
						<div style="height: 216px">
							<ul class="notice-list ul-dashed" th:each="o:${list}"
								th:if=" ${o.types} == '3' ">
								<li class="notice-li"><a class="name"
									th:href="@{/inforelease/info/detail?isHomePage=true(id=${o.id})}"><span
									th:title="${o.title}" th:text=${o.title}></span></a>
									<div class="right-tool">
										<span th:text=${o.releaseTime}></span>
									</div></li>
							</ul>
						</div>
					</div>
					</div>
				</div>
		</section>
	</div>
	<div th:replace="/hf/footer"></div>
	 <script type="text/javascript">
	//<![CDATA[
	 $(function() {
	        tuxing(myChart);
	    });

	    function query() {
	        tuxing(myChart);
	    }
    
    //图表自适应大小      
    window.addEventListener("resize", function() {
        myChart.resize();
    });
    
    var myChart = echarts.init(document.getElementById('main'));

    var value = $.parseJSON($("#tonto_constant_value").text());
    var job = value["KSYDYF_PJDJ"];
    
    function tuxing(myChart) {
        var cycleId = $('input[name="assessCycleId"]').val();
        $.postAjax("/console/appsum/search/eharts?cycleId=" + cycleId,
            function(result) {
                var list = result;
                var chartData = [];
                var charDatazx = [];
                var cache = {};
                list.forEach(function(item) {
                    if (item.unitAssGrade) {
                        for (var i = 0; i < job.length; i++) {
                            if (job[i].key == item.unitAssGrade) {
                                chartData.push({
                                    name: job[i].value,
                                    value: item.kpdc
                                });
                                charDatazx.push(job[i].value);
                                cache[job[i].key] = 1;
                                break;
                            }
                        }
                    }
                })
                 for (var i = 0; i < job.length; i++) {
                    if (!cache[job[i].key]) {
                        chartData.push({
                            name: job[i].value,
                            value: 0
                        });
                        charDatazx.push(job[i].value);
                    }
                }

                var option1 = {
                    title: {
                        text: '考评结果汇总图',
                        padding: 10,
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    toolbox: {
                        show: true,
                        padding: [20, 80, 5, 5],
                        feature: {
                            magicType: {
                                show: true,                                
                                type: ['line', 'bar']
                            },
                            saveAsImage: {
                                pixelRatio: 2
                            }
                        }
                    },
                    calculable: true,
                    xAxis: [{
                        type: 'category',
                        data: charDatazx
                    }],
                    yAxis: [{
                        type: 'value'
                    }],
                    series: [{
                        barWidth: 30,
                        name: '人数',
                        type: 'bar',
                        data: chartData
                    }]
                }
                myChart.setOption(option1);
            });
    }
               
    //]]>
    </script>
</body>
</html>